package com.assigment1.splashscreen;

import java.util.Date;

import android.support.v7.app.ActionBarActivity;
import android.content.Intent;
import android.os.Bundle;
import android.os.Handler;
import android.view.Window;

public class SplashScreenActivity extends ActionBarActivity {
	private static long firstTime;
	private static long summTime;
	private static long lastTime;
	private Runnable start; 
	private static final String TIIME = "myTime";
	private Handler handler = new Handler();
	
	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		getWindow().requestFeature(Window.FEATURE_NO_TITLE);

		setContentView(R.layout.activity_main);

		firstTime = 2000;
		Date firstDate = new Date();
		
		if(savedInstanceState!=null){
		Date now = new Date();
		firstTime = firstDate.getSeconds();//может лишнее
		summTime = savedInstanceState.getLong(TIIME);//все суммарное время
		firstTime = 2000 - (lastTime-firstTime);//все время минус начальное(800-300)
		}
		
		start = new Runnable() {
            
            // Using handler with postDelayed called runnable run method
  
            @Override
            public void run() {
                Intent i = new Intent(getBaseContext(), HomeActivity.class);
                startActivity(i);
                // close this activity
                finish();
            }
        };
	}
	
	protected void onStart(){
		super.onStart();
		handler.postDelayed(start, firstTime);
	}
	
	public void onSaveInstanceState(Bundle saveInstanceState){
		Date on = new Date();
		summTime = on.getSeconds();
		saveInstanceState.putLong(TIIME, summTime);
		super.onSaveInstanceState(saveInstanceState);
	}
	
	protected void onStop(){
		 super.onStop();
		 handler.removeCallbacks(start);
	 }
}
